LDI $0 ; INICIO DO SETUP
STA HEX0
STA HEX1
STA HEX2
STA HEX3
STA HEX4
STA HEX5
STA LEDR0-7
STA LEDR8
STA LEDR9
STA FPGA_RESET
STA @0 ;UNIDADR
STA @1 ;DEZENA
STA @2 ;CENTENA
STA @3 ; VALOR 0
STA CLR-KEY0
STA CLR-KEY1

LDI $1
STA @4 ; VALOR 1

LDI $10
STA @5 ; VALOR 10

LDI $0
STA @6 ;FLAG

MAIN

JSR ESCREVE-HEX

JSR LIMITE-DE-CONTAGEM

LDA KEY0
ANDOP @4
CEQ @3
JEQ PASS-INCREMENTA
JSR INCREMENTA-VALOR
PASS-INCREMENTA

LDA KEY1
ANDOP @4
CEQ @3 
JEQ PASS-CONFIG
;JSR CONFIG-LIMITE
PASS-CONFIG

JMP MAIN


ESCREVE-HEX 
LDA @0
STA HEX0
NOP
LDA @1
STA HEX1
NOP
LDA @2
STA HEX2
RET


INCREMENTA-VALOR
STA CLR-KEY0
LDA @6
CEQ @4
JEQ VOLTA-VALOR

LDA @0  ; UNIDADE
SOMA @4 ; A+1
STA @0 ; UNIDADE
CEQ @5 ; A == 10
JEQ INC-TENS
NOP
RET

INC-TENS
LDI $0
STA @0 ;ZERA UNIDADE
LDA @1 ;DEZENA
SOMA @4 ; A+1
STA @1
CEQ @5 ; A == 10
JEQ INC-HUNDREDS
NOP
RET

INC-HUNDREDS
LDI $0
STA @1 ; ZERA DEZENA
LDA @2 ; CENTENA
SOMA @4 ; A+1
STA @2
CEQ @5 ; A == 10
JEQ ZERO
NOP
RET

ZERO
LDI $0
STA @2

LDI $1
STA LEDR9 ;LED OVERFLOW
STA @6

VOLTA-VALOR
RET



CONFIG-LIMITE

DEFINE-UNIDADE
STA CLR-KEY1
LDA SW0_7
STA @0

LDA KEY1
ANDOP @4
CEQ @4
JSR DEFINE-DEZENA
JMP DEFINE-UNIDADE

DEFINE-DEZENA
STA CLR-KEY1
LDA SW0_7
STA @1

LDA KEY1
ANDOP @4
CEQ @4
JSR DEFINE-CENTENA
JMP DEFINE-DEZENA

DEFINE-CENTENA
STA CLR-KEY1
LDA SW0_7
STA @2

LDA KEY1
ANDOP @4
CEQ @4
JSR MAIN
JMP DEFINE-CENTENA

LIMITE-DE-CONTAGEM

LDA @2
SOMA @4
CEQ @5
JEQ PROX--DEZENA
RET

PROX--DEZENA
LDA @1
SOMA @4
CEQ @5
JEQ PROX--UNIDADE
RET

PROX--UNIDADE
LDA @0
SOMA @4
CEQ @5
JEQ PROX--NADA
RET

PROX--NADA
LDI $1
STA @6
STA LEDR8
RET

RENICIAR-CONT
LDI $0
STA @0
STA @1
STA @2
STA @6
STA LEDR8
STA LEDR9
RET